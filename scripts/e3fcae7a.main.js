window.Stem={Collections:{},Models:{},Routers:{},Views:{},config:{donorsChooseApiKey:"DONORSCHOOSE",oae:{host:"stemincubator.oae-qa1.oaeproject.org",protocol:"http:"}},init:function(){"use strict";new Stem.Routers.App}},$(document).ready(function(){"use strict";Stem.init()}),this.JST=this.JST||{},this.JST["app/scripts/templates/completedProposalAsFeaturedDetailsItem.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<div class="featured__details__image">\n    <img src="'+(null==(__t=thumbImageURL)?"":__t)+'" width="100" height="100"/>\n</div>\n<div class="featured__details__text">\n    <h4 class="featured__details__title">'+(null==(__t=title)?"":__t)+"</h4>\n    <p>"+(null==(__t=shortDescription)?"":__t)+'</p>\n    <p>\n        <a href="'+(null==(__t=proposalURL)?"":__t)+'" class="button button--link">\n            $',print(Math.round(+totalPrice)),__p+=" funded\n        </a>\n    </p>\n</div>\n";return __p},this.JST["app/scripts/templates/completedProposalsAsFeaturedDetails.ejs"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<h3 class="featured__details__heading">Successful Projects in Georgia</h3>\n<div class="featured__details__listing"></div>\n<p>\n    <a class="button button--large button--link"\n       href="http://www.donorschoose.org/donors/search.html?max=10&state=GA&subject4=-4&historical=true">\n        Show me more\n    </a>\n<p>\n';return __p},this.JST["app/scripts/templates/contentAsFeaturedDetails.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<h3 class="featured__details__heading">Selected Content</h3>\n<div class="featured__details__listing"></div>\n<p>\n    <a class="button button--large button--link"\n       href="',print(Stem.config.oae.protocol+"//"+Stem.config.oae.host+"/search/?types=content"),__p+='">\n        Show me more\n    </a>\n<p>\n';return __p},this.JST["app/scripts/templates/contentAsFeaturedDetailsItem.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<div class="featured__details__image">\n    <img src="',print(Stem.config.oae.protocol+"//"+Stem.config.oae.host+thumbnailUrl),__p+='"\n         width="100" height="100"/>\n</div>\n<div class="featured__details__text">\n    <h4 class="featured__details__title">'+(null==(__t=displayName)?"":__t)+"</h4>\n    <p>"+(null==(__t=description)?"":__t)+'</p>\n    <p>\n        <a href="',print(Stem.config.oae.protocol+"//"+Stem.config.oae.host+profilePath),__p+='"\n           class="button button--link">\n            More Details\n        </a>\n    </p>\n</div>\n\n';return __p},this.JST["app/scripts/templates/groupAsFeaturedDetailsItem.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<div class="featured__details__image">\n    <img src="',print(Stem.config.oae.protocol+"//"+Stem.config.oae.host+thumbnailUrl),__p+='"\n         width="100" height="100"/>\n</div>\n<div class="featured__details__text">\n    <h4 class="featured__details__title">'+(null==(__t=displayName)?"":__t)+"</h4>\n    <p>"+(null==(__t=description)?"":__t)+'</p>\n    <p>\n        <a href="',print(Stem.config.oae.protocol+"//"+Stem.config.oae.host+profilePath),__p+='"\n           class="button button--link">\n            More Details\n        </a>\n    </p>\n</div>';return __p},this.JST["app/scripts/templates/groupsAsFeaturedDetails.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<h3 class="featured__details__heading">Selected Groups</h3>\n<div class="featured__details__listing"></div>\n<p>\n    <a class="button button--large button--link"\n       href="',print(Stem.config.oae.protocol+"//"+Stem.config.oae.host+"/search/?types=group"),__p+='">\n        Show me more\n    </a>\n<p>\n';return __p},this.JST["app/scripts/templates/proposalAsHighlight.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<div class="img-highlight"><img src="'+(null==(__t=imageURL)?"":__t)+'"></div>\n<h4>'+(null==(__t=title)?"":__t)+"</h4>\n<p>"+(null==(__t=shortDescription)?"":__t)+"</p>\n<p>"+(null==(__t=fulfillmentTrailer)?"":__t)+'</p>\n<div class="well well-sm">\nTotal cost: $',print(Math.round(+totalPrice)),__p+=" / $",print(Math.round(+costToComplete)),__p+=" to go <br/>\n"+(null==(__t=schoolName)?"":__t)+"<br/>\n",povertyLevel&&print("("+povertyLevel+")<br/>"),__p+="\n"+(null==(__t=city)?"":__t)+", GA\n</div>\n<p><a href="+(null==(__t=proposalURL)?"":__t)+'">Give to this class Â»</a></p>';return __p},this.JST["app/scripts/templates/proposalsAsHighlights.ejs"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+="\n";return __p},this.JST["app/scripts/templates/subjectAsSelectionItem.ejs"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__j=(_.escape,Array.prototype.join);with(obj)__p+='<input type="checkbox" id="'+(null==(__t=id)?"":__t)+'" ',selected&&print("checked"),__p+=' />\n<label class="vertical-selection__item-label" for="'+(null==(__t=id)?"":__t)+'">'+(null==(__t=subject)?"":__t)+"</label>\n";return __p},this.JST["app/scripts/templates/subjectsAsSelection.ejs"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<form class="vertical-selection">\n    <fieldset>\n        <label class="vertical-selection__label">Subjects:</label>\n   </fieldset>\n</form>\n';return __p},function(a){"use strict";function b(b,e){this.element=b,this.settings=a.extend({},d,e),this._defaults=d,this._name=c,this.init()}var c="featured",d={};a.extend(b.prototype,{init:function(){var b=a(this.element).hasClass("featured")?a(this.element):a(this.element).find(".featured");b.find("[data-featured-toggle]").on("click",function(){var c=a(this).attr("data-featured-toggle");return"0"===b.attr("data-featured-selection")&&b.find('[data-featured-details="'+c+'"]').each(function(){var b=a(this).outerHeight();a(this).css("height",0).animate({height:b},400,function(){a(this).css("height","auto")})}),b.attr("data-featured-selection",c),!1}),b.find("[data-featured-close]").on("click",function(){var c=a(this).parents("[data-featured-details]").attr("data-featured-details");return b.find('[data-featured-details="'+c+'"]').animate({height:"0"},400,function(){a(this).css("height","auto"),b.attr("data-featured-selection","0")}),!1})}}),a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})},a(".featured").featured()}(jQuery,window,document),$(document).ready(function(){"use strict";$("#nav-toggle").on("change",function(){$("main").attr("data-nav-expanded",$("#nav-toggle").prop("checked"))})}),Stem.Models=Stem.Models||{},function(){"use strict";Stem.Models.Content=Backbone.Model.extend({url:function(){return Stem.config.oae.protocol+"//"+Stem.config.oae.host+"/api/content/"+this.id},parse:function(a){a.description=a.description||"",a.displayName=a.displayName||"",a.thumbnailUrl=a.thumbnailUrl||"",a.profilePath=a.profilePath||"";var b=["elementary","middle","high"];if(a.displayName){var c=a.displayName.split(" - ").map(function(a){return a.trim()});if(a.displayName=c[0],c.length>1){var d=c[1].split(",").map(function(a){return a.trim().toLowerCase()});b.forEach(function(b){a[b]=d.some(function(a){return-1!==a.indexOf(b)})})}b.some(function(b){return a[b]})||b.forEach(function(b){a[b]=!0}),a.subjects=[],c.length>2&&c[2].split(",").forEach(function(b){a.subjects.push(b.trim())})}return a}})}(),Stem.Models=Stem.Models||{},function(){"use strict";Stem.Models.Group=Backbone.Model.extend({url:function(){return Stem.config.oae.protocol+"//"+Stem.config.oae.host+"/api/group/"+this.id},parse:function(a){a.description=a.description||"",a.displayName=a.displayName||"",a.thumbnailUrl=a.thumbnailUrl||"",a.profilePath=a.profilePath||"";var b=["elementary","middle","high"];if(a.displayName){var c=a.displayName.split(" - ").map(function(a){return a.trim()});if(a.displayName=c[0],c.length>1){var d=c[1].split(",").map(function(a){return a.trim().toLowerCase()});b.forEach(function(b){a[b]=d.some(function(a){return-1!==a.indexOf(b)})})}b.some(function(b){return a[b]})||b.forEach(function(b){a[b]=!0}),a.subjects=[],c.length>2&&c[2].split(",").forEach(function(b){a.subjects.push(b.trim())})}return a}})}(),Stem.Models=Stem.Models||{},function(){"use strict";Stem.Models.Proposal=Backbone.Model.extend({sync:function(a,b,c){if("read"!==a)throw"Attempt to write read-only Proposal model";return c.dataType="jsonp",Backbone.sync(a,b,c)},url:function(){return"http://api.donorschoose.org/common/json_feed.html?APIKey="+Stem.config.donorsChooseApiKey+"&id="+this.get("id")},initialize:function(){},defaults:{},validate:function(a){return _(a.title).isString()?_(a.thumbImageURL).isString()?_(a.imageURL).isString()?_(a.shortDescription).isString()?_(a.schoolName).isString()?_(a.city).isString()?_(a.fulfillmentTrailer).isString()?_(a.proposalURL).isString()?_(a.povertyLevel).isString()?_(a.totalPrice).isString()?_(a.costToComplete).isString()?_(a.gradeLevel).isObject()&&_(a.gradeLevel.id).isString()?"5"===a.gradeLevel.id?"Proposal is for adult education":void 0:"Proposal doesn't have a valid grade level":"Proposal doesn't have a valid cost to complete":"Proposal doesn't have a valid total price":"Proposal doesn't have a valid poverty level":"Proposal doesn't have a valid proposal URL":"Proposal doesn't have a valid fulfillment trailer":"Proposal doesn't have a valid city":"Proposal doesn't have a valid school":"Proposal doesn't have a valid description":"Proposal doesn't have a valid image":"Proposal doesn't have a valid thumbnail image":"Proposal doesn't have a valid title"},parse:function(a){return a.proposals&&_(a.proposals).isArray()?a.proposals[0]:a}})}(),Stem.Models=Stem.Models||{},function(){"use strict";Stem.Models.Subject=Backbone.Model.extend({})}(),Stem.Collections=Stem.Collections||{},function(){"use strict";Stem.Collections.Content=Backbone.Collection.extend({model:Stem.Models.Content,initialize:function(a,b){var c=b||{};this.options={},this.options.limit=c.limit,this.options.keywords=c.keywords},url:function(){return Stem.config.oae.protocol+"//"+Stem.config.oae.host+"/api/search/general?resourceTypes=content&scope=_tenant"+(this.options.limit?"&limit="+this.options.limit:"")+(this.options.keywords?"&q="+this.options.keywords:"")},parse:function(a){return a.results?a.results:a},getSubjects:function(){var a=[];return this.models.forEach(function(b){b.get("subjects").forEach(function(b){a.some(function(a){return a===b})||a.push(b)})}),a}})}(),Stem.Collections=Stem.Collections||{},function(){"use strict";Stem.Collections.Groups=Backbone.Collection.extend({model:Stem.Models.Group,initialize:function(a,b){var c=b||{};this.options={},this.options.limit=c.limit,this.options.keywords=c.keywords},url:function(){return Stem.config.oae.protocol+"//"+Stem.config.oae.host+"/api/search/general?resourceTypes=group&scope=_tenant"+(this.options.limit?"&limit="+this.options.limit:"")+(this.options.keywords?"&q="+this.options.keywords:"")},parse:function(a){return a.results?a.results:a},getSubjects:function(){var a=[];return this.models.forEach(function(b){b.get("subjects").forEach(function(b){a.some(function(a){return a===b})||a.push(b)})}),a}})}(),Stem.Collections=Stem.Collections||{},function(){"use strict";Stem.Collections.Proposals=Backbone.Collection.extend({model:Stem.Models.Proposal,initialize:function(a,b){var c=b||{};this.options={};var d={"Health & Life Science":"4","Applied Science":"6","Environmental Science":"7",Mathematics:"8"};this.options.subject=c.subject&&d[c.subject]?d[c.subject]:"-4";var e={primary:"1",elementary:"2",middle:"3",high:"4",adult:"5"};c.grade&&e[c.grade]&&(this.options.grade=e[c.grade]);var f={urgency:"0",poverty:"1",cost:"2",popularity:"4",expiration:"5",newest:"7"};c.sortBy&&f[c.sortBy]&&(this.options.sortBy=f[c.sortBy]),this.options.maxSize=c.maxSize,this.options.keywords=c.keywords,this.options.historical=c.historical},sync:function(a,b,c){if("read"!==a)throw"Attempt to write read-only Proposals collection";return c.dataType="jsonp",Backbone.sync(a,b,c)},url:function(){return"http://api.donorschoose.org/common/json_feed.html?APIKey="+Stem.config.donorsChooseApiKey+"&state=GA&subject4="+this.options.subject+(this.options.grade?"&gradeType="+this.options.grade:"")+(this.options.keywords?'&keywords="'+encodeURIComponent(this.options.keywords)+'"':"")+(this.options.maxSize?"&max="+this.options.maxSize:"")+(this.options.historical?"&historical=true":"")+(this.options.sortBy?"&sortBy="+this.options.sortBy:"")},fetch:function(a){return Backbone.Collection.prototype.fetch.call(this,_({}).extend(a,{validate:!0}))},parse:function(a){return a.proposals}})}(),Stem.Collections=Stem.Collections||{},function(){"use strict";Stem.Collections.Subjects=Backbone.Collection.extend({model:Stem.Models.Subject})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.CompletedProposalAsFeaturedDetailsItem=Backbone.View.extend({template:JST["app/scripts/templates/completedProposalAsFeaturedDetailsItem.ejs"],tagName:"div",id:"",className:"featured__details__item",events:{},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.CompletedProposalsAsFeaturedDetails=Backbone.View.extend({template:JST["app/scripts/templates/completedProposalsAsFeaturedDetails.ejs"],tagName:"div",id:"",className:"",events:{},initialize:function(){this.listenTo(this.collection,"reset sync",this.render)},render:function(){var a=this.$el;return a.html(this.template()),this.collection.each(function(b){var c=new Stem.Views.CompletedProposalAsFeaturedDetailsItem({model:b});c.render(),a.find(".featured__details__listing").append(c.el)}),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.ContentAsFeaturedDetailsItem=Backbone.View.extend({template:JST["app/scripts/templates/contentAsFeaturedDetailsItem.ejs"],tagName:"div",id:"",className:"featured__details__item",events:{},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.ContentAsFeaturedDetails=Backbone.View.extend({template:JST["app/scripts/templates/contentAsFeaturedDetails.ejs"],tagName:"div",id:"",className:"",events:{},initialize:function(){this.listenTo(this.collection,"reset sync",this.render)},render:function(){var a=this.$el;return a.html(this.template()),this.collection.each(function(b){var c=new Stem.Views.ContentAsFeaturedDetailsItem({model:b});c.render(),a.find(".featured__details__listing").append(c.el)}),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.GroupAsFeaturedDetailsItem=Backbone.View.extend({template:JST["app/scripts/templates/groupAsFeaturedDetailsItem.ejs"],tagName:"div",id:"",className:"featured__details__item",events:{},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.GroupsAsFeaturedDetails=Backbone.View.extend({template:JST["app/scripts/templates/groupsAsFeaturedDetails.ejs"],tagName:"div",id:"",className:"",events:{},initialize:function(){this.listenTo(this.collection,"reset sync",this.render)},render:function(){var a=this.$el;return a.html(this.template()),this.collection.each(function(b){var c=new Stem.Views.ContentAsFeaturedDetailsItem({model:b});c.render(),a.find(".featured__details__listing").append(c.el)}),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.SubjectAsSelectionItem=Backbone.View.extend({template:JST["app/scripts/templates/subjectAsSelectionItem.ejs"],events:{"change input":"change"},change:function(){var a=this.$el.find("input").is(":checked");this.model.set("selected",a),this.trigger("selection:change",this.model,a)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.SubjectsAsSelection=Backbone.View.extend({template:JST["app/scripts/templates/subjectsAsSelection.ejs"],initialize:function(){this.listenTo(this.collection,"reset sync",this.render)},render:function(){var a=this,b=this.$el;return b.html(this.template()),this.collection.each(function(c){var d=new Stem.Views.SubjectAsSelectionItem({model:c});d.render(),b.find("fieldset").append(d.el),a.listenTo(d,"selection:change",a.selectionChanged)}),this},selectionChanged:function(){var a=[];this.collection.each(function(b){b.get("selected")&&a.push(b.get("subject"))}),this.collection.trigger("selection:change",a)}})}(),Stem.Views=Stem.Views||{},function(){"use strict";Stem.Views.Teachers=Backbone.View.extend({filters:{grade:[],content:{subject:[]},group:{subject:[]}},initialize:function(){var a=this;this.content=new Stem.Collections.Content([],{limit:99}),this.contentSubjects=new Stem.Collections.Subjects,this.content.on("sync reset",this.updateContentSubjects,this),this.contentSubjects.on("selection:change",this.updateContentFilters,this),this.content.fetch(),this.groups=new Stem.Collections.Groups([],{limit:99}),this.groupSubjects=new Stem.Collections.Subjects,this.groups.on("sync reset",this.updateGroupSubjects,this),this.groupSubjects.on("selection:change",this.updateGroupFilters,this),this.groups.fetch(),this.completedProposals=new Stem.Collections.Proposals([],{historical:!0,maxSize:5}),this.completedProposals.fetch(),this.filteredContent=new FilteredCollection(this.content),this.filteredContent.filterBy(function(b){var c=0===a.filters.grade.length||b.get("elementary")&&-1!==_(a.filters.grade).indexOf("elementary")||b.get("middle")&&-1!==_(a.filters.grade).indexOf("middle")||b.get("high")&&-1!==_(a.filters.grade).indexOf("high"),d=0===a.filters.content.subject.length||0===b.get("subjects").length||_(b.get("subjects")).any(function(b){return-1!==a.filters.content.subject.indexOf(b)});return c&&d}),this.filteredGroups=new FilteredCollection(this.groups),this.filteredGroups.filterBy(function(b){var c=0===a.filters.grade.length||b.get("elementary")&&-1!==_(a.filters.grade).indexOf("elementary")||b.get("middle")&&-1!==_(a.filters.grade).indexOf("middle")||b.get("high")&&-1!==_(a.filters.grade).indexOf("high"),d=0===a.filters.group.subject.length||0===b.get("subjects").length||_(b.get("subjects")).any(function(b){return-1!==a.filters.group.subject.indexOf(b)});return c&&d}),$("input","#grade-selection").on("change",function(){a.filters.grade=[],$("#cb-elementary").is(":checked")&&a.filters.grade.push("elementary"),$("#cb-middle").is(":checked")&&a.filters.grade.push("middle"),$("#cb-high").is(":checked")&&a.filters.grade.push("high"),a.filteredContent.refilter(),a.filteredGroups.refilter()})},updateContentSubjects:function(){this.contentSubjects.reset(this.content.getSubjects().map(function(a){return new Stem.Models.Subject({id:_.uniqueId("content_subject_"),selected:!1,subject:a})}))},updateGroupSubjects:function(){this.groupSubjects.reset(this.groups.getSubjects().map(function(a){return new Stem.Models.Subject({id:_.uniqueId("group_subject_"),selected:!1,subject:a})}))},updateContentFilters:function(a){this.filters.content.subject=a,this.filteredContent.refilter()},updateGroupFilters:function(a){this.filters.group.subject=a,this.filteredGroups.refilter()},render:function(){var a=new Stem.Views.SubjectsAsSelection({collection:this.contentSubjects,el:$("#content-subjects")[0]});a.render();var b=new Stem.Views.ContentAsFeaturedDetails({collection:this.filteredContent,el:$("#content-details")[0]});b.render();var c=new Stem.Views.SubjectsAsSelection({collection:this.groupSubjects,el:$("#group-subjects")[0]});c.render();var d=new Stem.Views.GroupsAsFeaturedDetails({collection:this.filteredGroups,el:$("#group-details")[0]});d.render();var e=new Stem.Views.CompletedProposalsAsFeaturedDetails({collection:this.completedProposals,el:$("#proposals-details")[0]});e.render()}})}(),Stem.Routers=Stem.Routers||{},function(){"use strict";Stem.Routers.App=Backbone.Router.extend({routes:{"":"landing",teachers:"teachers",schools:"schools",industry:"industry"},loadPage:function(a){$("section").not("#"+a+"_page").removeClass("show").addClass("hide"),$("section#"+a+"_page").removeClass("hide").addClass("show"),$(".header").attr("data-section",a),$("#nav-toggle").prop("checked",0),$("main").attr("data-nav-expanded",!1),_.defer(window.scrollTo,0,0)},landing:function(){this.loadPage("landing")},teachers:function(){this.loadPage("teachers")},schools:function(){this.loadPage("schools")},industry:function(){this.loadPage("industry")},initialize:function(){$("section").each(function(){var a=$(this).attr("id");$(this).attr("id",a+"_page")}),Backbone.history.start(),this.teacher=(new Stem.Views.Teachers).render()}})}();