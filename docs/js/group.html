<!DOCTYPE html>

<html>
<head>
  <title>group.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="content.html">
                content.js
              </a>
            
              
              <a class="source" href="groups.html">
                groups.js
              </a>
            
              
              <a class="source" href="proposals.html">
                proposals.js
              </a>
            
              
              <a class="source" href="searchFilters.html">
                searchFilters.js
              </a>
            
              
              <a class="source" href="tags.html">
                tags.js
              </a>
            
              
              <a class="source" href="style-helpers.html">
                style-helpers.js
              </a>
            
              
              <a class="source" href="utils.html">
                utils.js
              </a>
            
              
              <a class="source" href="index.html">
                index.js
              </a>
            
              
              <a class="source" href="main.html">
                main.js
              </a>
            
              
              <a class="source" href="content.html">
                content.js
              </a>
            
              
              <a class="source" href="group.html">
                group.js
              </a>
            
              
              <a class="source" href="proposal.html">
                proposal.js
              </a>
            
              
              <a class="source" href="search.html">
                search.js
              </a>
            
              
              <a class="source" href="searchFilter.html">
                searchFilter.js
              </a>
            
              
              <a class="source" href="searchGroup.html">
                searchGroup.js
              </a>
            
              
              <a class="source" href="tag.html">
                tag.js
              </a>
            
              
              <a class="source" href="tagSet.html">
                tagSet.js
              </a>
            
              
              <a class="source" href="teacherSearch.html">
                teacherSearch.js
              </a>
            
              
              <a class="source" href="app.html">
                app.js
              </a>
            
              
              <a class="source" href="oaeAsMainSearchGroup.html">
                oaeAsMainSearchGroup.js
              </a>
            
              
              <a class="source" href="oaeAsMainSearchResult.html">
                oaeAsMainSearchResult.js
              </a>
            
              
              <a class="source" href="oaeAsMainSearchResults.html">
                oaeAsMainSearchResults.js
              </a>
            
              
              <a class="source" href="oaeAsSecondarySearchGroup.html">
                oaeAsSecondarySearchGroup.js
              </a>
            
              
              <a class="source" href="oaeAsSecondarySearchResult.html">
                oaeAsSecondarySearchResult.js
              </a>
            
              
              <a class="source" href="oaeAsSecondarySearchResults.html">
                oaeAsSecondarySearchResults.js
              </a>
            
              
              <a class="source" href="searchFilterAsItem (iMac's conflicted copy 2015-03-17).html">
                searchFilterAsItem (iMac's conflicted copy 2015-03-17).js
              </a>
            
              
              <a class="source" href="searchFilterAsItem.html">
                searchFilterAsItem.js
              </a>
            
              
              <a class="source" href="searchFiltersAsList.html">
                searchFiltersAsList.js
              </a>
            
              
              <a class="source" href="searchForm.html">
                searchForm.js
              </a>
            
              
              <a class="source" href="tagAsCheckbox.html">
                tagAsCheckbox.js
              </a>
            
              
              <a class="source" href="tagSetAsCheckboxGroup.html">
                tagSetAsCheckboxGroup.js
              </a>
            
              
              <a class="source" href="tagsAsCheckboxes.html">
                tagsAsCheckboxes.js
              </a>
            
              
              <a class="source" href="teacherSearchPage.html">
                teacherSearchPage.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>group.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/*global Stem, Backbone*/</span>

Stem.Models = Stem.Models || {};

(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
<span class="hljs-pi">    'use strict'</span>;

    Stem.Models.Group = Backbone.Model.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>The only thing we need to provide for this
model (other than Backbone defaults) is the
URL to access it. Unlike typical Backbone
implementations, it’s more likely that any
collections of this model will be acquired
through a different REST endpoint (e.g.
search). We define the REST endpoint for the
full group object in case those other
endpoints only provide a summary. In such
cases, calling <code>fetch()</code> on a model will
update it with the complete profile.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        url: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> Stem.config.oae.protocol + <span class="hljs-string">'//'</span> +
                   Stem.config.oae.host + <span class="hljs-string">'/api/group/'</span> + <span class="hljs-keyword">this</span>.id;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>We need to parse the response from the server
to extract the grade level and tags from
the overloaded title. While we’re at it, we
also clean up the response a bit to avoid
nasty surprises.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        parse: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(response)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>First make sure we have values for all
required properties.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            response.description  = response.description  || <span class="hljs-string">''</span>;
            response.displayName  = response.displayName  || <span class="hljs-string">''</span>;
            response.thumbnailUrl = response.thumbnailUrl || <span class="hljs-string">''</span>;
            response.profilePath   = response.profilePath   || <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Define an array that lists the grade levels
we support.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">var</span> allGrades = [<span class="hljs-string">'elementary'</span>, <span class="hljs-string">'middle'</span>, <span class="hljs-string">'high'</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>The extra information is contained in the
<code>displayName</code> property.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">if</span> (response.displayName) {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>First, split <code>displayName</code> up by
dashes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                <span class="hljs-keyword">var</span> tokens = response.displayName.split(<span class="hljs-string">' - '</span>)
                    .map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(token)</span> </span>{
                         <span class="hljs-keyword">return</span> token.trim();
                    });</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>The real <code>displayName</code> is the first of
these tokens.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                response.displayName = tokens[<span class="hljs-number">0</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>The second part of the original
<code>displayName</code> holds the grade
levels. Multiple grade levels are
permitted, separated by commas.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                <span class="hljs-keyword">if</span> (tokens.length &gt; <span class="hljs-number">1</span>) {

                    <span class="hljs-keyword">var</span> grades = tokens[<span class="hljs-number">1</span>].split(<span class="hljs-string">','</span>)
                        .map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(token)</span> </span>{
                             <span class="hljs-keyword">return</span> token.trim().toLowerCase();
                        });</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>We’re pretty forgiving about how
the grade levels are formatted.
We look for any fragment that
matches the relevant keyword.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                    allGrades.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(grade)</span> </span>{
                        response[grade] = grades
                            .some(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(token)</span> </span>{
                                <span class="hljs-keyword">return</span> token.indexOf(grade) !== -<span class="hljs-number">1</span>;
                            });
                    });

                }</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>If no grades were specified, then
the content is considered tagged for
all grades.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                <span class="hljs-keyword">if</span> (!allGrades.some(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(grade)</span> </span>{
                    <span class="hljs-keyword">return</span> response[grade];
                })) {
                    allGrades.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(grade)</span> </span>{
                        response[grade] = <span class="hljs-literal">true</span>;
                    });
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Finally, the third part of the
original <code>displayName</code> holds the
tags. Again, there may be
multiple tags separated by
commas. This time, though, we’re
not going to interpret the values.
We just store them as an array.</p>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>To handle the case of no tags
cleanly, start with an empty array.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                response.tags = [];

                <span class="hljs-keyword">if</span> (tokens.length &gt; <span class="hljs-number">2</span>) {

                    tokens[<span class="hljs-number">2</span>].split(<span class="hljs-string">','</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(token)</span> </span>{
                        response.tags.push(token.trim());
                    });

                }

            }

            <span class="hljs-keyword">return</span> response;

        }

    });

})();</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
