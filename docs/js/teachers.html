<!DOCTYPE html>

<html>
<head>
  <title>teachers.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="content.html">
                content.js
              </a>
            
              
              <a class="source" href="groups.html">
                groups.js
              </a>
            
              
              <a class="source" href="proposals.html">
                proposals.js
              </a>
            
              
              <a class="source" href="tags.html">
                tags.js
              </a>
            
              
              <a class="source" href="featured.html">
                featured.js
              </a>
            
              
              <a class="source" href="style-helpers.html">
                style-helpers.js
              </a>
            
              
              <a class="source" href="index.html">
                index.js
              </a>
            
              
              <a class="source" href="main.html">
                main.js
              </a>
            
              
              <a class="source" href="content.html">
                content.js
              </a>
            
              
              <a class="source" href="group.html">
                group.js
              </a>
            
              
              <a class="source" href="proposal.html">
                proposal.js
              </a>
            
              
              <a class="source" href="tag.html">
                tag.js
              </a>
            
              
              <a class="source" href="tagSet.html">
                tagSet.js
              </a>
            
              
              <a class="source" href="app.html">
                app.js
              </a>
            
              
              <a class="source" href="completedProposalAsFeaturedDetailsItem.html">
                completedProposalAsFeaturedDetailsItem.js
              </a>
            
              
              <a class="source" href="completedProposalsAsFeaturedDetails.html">
                completedProposalsAsFeaturedDetails.js
              </a>
            
              
              <a class="source" href="contentAsFeaturedDetails.html">
                contentAsFeaturedDetails.js
              </a>
            
              
              <a class="source" href="contentAsFeaturedDetailsItem.html">
                contentAsFeaturedDetailsItem.js
              </a>
            
              
              <a class="source" href="groupAsFeaturedDetailsItem.html">
                groupAsFeaturedDetailsItem.js
              </a>
            
              
              <a class="source" href="groupsAsFeaturedDetails.html">
                groupsAsFeaturedDetails.js
              </a>
            
              
              <a class="source" href="proposalAsHighlight.html">
                proposalAsHighlight.js
              </a>
            
              
              <a class="source" href="proposalsAsHighlights.html">
                proposalsAsHighlights.js
              </a>
            
              
              <a class="source" href="tagAsHorizontalSelectionItem.html">
                tagAsHorizontalSelectionItem.js
              </a>
            
              
              <a class="source" href="tagAsVerticalSelectionItem.html">
                tagAsVerticalSelectionItem.js
              </a>
            
              
              <a class="source" href="tagSetAsHorizontalSelection.html">
                tagSetAsHorizontalSelection.js
              </a>
            
              
              <a class="source" href="tagSetAsVerticalSelection.html">
                tagSetAsVerticalSelection.js
              </a>
            
              
              <a class="source" href="tagsAsHorizontalSelection.html">
                tagsAsHorizontalSelection.js
              </a>
            
              
              <a class="source" href="tagsAsVerticalSelection.html">
                tagsAsVerticalSelection.js
              </a>
            
              
              <a class="source" href="teachers.html">
                teachers.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>teachers.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* global Stem, $, _, Backbone, FilteredCollection */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Backbone view for the teacher-focused
page of the application. This view is
a parent view for various components
and does not have an associated model
or collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
Stem.Views = Stem.Views || {};

(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
<span class="hljs-pi">    'use strict'</span>;

    Stem.Views.Teachers = Backbone.View.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="filters">filters</h2>
<p>We use an object to keep track of the current
state of filtering for teachers details. There
is a general filter for grade level that applies
(almost) everywhere, and there are tag-level
filters that apply separately to content and to
groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        filters: {
            grade: [],
            content: {
                tags: []
            },
            group: {
                tags: []
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="filtermodel-">filterModel()</h2>
<p>Utility function to check a model against a set
of filters. Grade level filtering is assumed; 
an optional tag array can also be supplied.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        
        filterModel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model, tags)</span> </span>{
            
            <span class="hljs-keyword">var</span> gradeFilters = <span class="hljs-keyword">this</span>.gradeTagSet.getSelectedTags();</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>The grade level matches if either:</p>
<ul>
<li>there are no grade level filters defined, or</li>
<li>at least one of the grade level filters matches
at least one of the content grade levels</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">var</span> gradeOk = (gradeFilters.length === <span class="hljs-number">0</span>) ||
                (model.get(<span class="hljs-string">'primary'</span>) &amp;&amp;
                _(gradeFilters).indexOf(<span class="hljs-string">'K-2'</span>)  !== -<span class="hljs-number">1</span>) ||
                (model.get(<span class="hljs-string">'elementary'</span>) &amp;&amp;
                _(gradeFilters).indexOf(<span class="hljs-string">'3-5'</span>)  !== -<span class="hljs-number">1</span>) ||
                (model.get(<span class="hljs-string">'middle'</span>)     &amp;&amp;
                _(gradeFilters).indexOf(<span class="hljs-string">'6-8'</span>)  !== -<span class="hljs-number">1</span>) ||
                (model.get(<span class="hljs-string">'high'</span>)       &amp;&amp;
                _(gradeFilters).indexOf(<span class="hljs-string">'9-12'</span>) !== -<span class="hljs-number">1</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>The tags match if either:</p>
<ul>
<li>there are no tag filters defined, or</li>
<li>at least one of the tags in the model
matches at least one of the tags in the
filter.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">var</span> tagsOk = (!_.isArray(tags)) || (tags.length === <span class="hljs-number">0</span>) ||
                _(model.get(<span class="hljs-string">'tags'</span>)).any(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tag)</span> </span>{
                    <span class="hljs-keyword">return</span> tags.indexOf(tag) !== -<span class="hljs-number">1</span>;
                });

            <span class="hljs-keyword">return</span> gradeOk &amp;&amp; tagsOk;

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2 id="setupcontent-">setupContent()</h2>
<p>Set up the models and collections for content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        
        setupContent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Create a collection of content objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.content = <span class="hljs-keyword">new</span> Stem.Collections.Content([], {
                limit: <span class="hljs-number">99</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Create a collection of tags for content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.contentTags = <span class="hljs-keyword">new</span> Stem.Collections.Tags();</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>And create a model for the set of content tags.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
            <span class="hljs-keyword">this</span>.contentTagSet = <span class="hljs-keyword">new</span> Stem.Models.TagSet({
                tags: <span class="hljs-keyword">this</span>.contentTags,
                title: <span class="hljs-string">'Subjects'</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Update the tags whenever the underlying
collection changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.content.on(<span class="hljs-string">'sync reset'</span>, <span class="hljs-keyword">this</span>.updateContentTags, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Update the tag filters whenever the user changes one.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.contentTags.on(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.updateContentFilters, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Populate the collections with content from the OAE.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.content.fetch();

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2 id="updatecontenttags-">updateContentTags()</h2>
<p>Update the list of valid tags for content whenever
the content collection itself changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        updateContentTags: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Reset the content tags collection with
an updated array of models.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.contentTags.reset(</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Create models from the tag now
available in the content collection.
Initially no tags are selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                <span class="hljs-keyword">this</span>.content.getTags().map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tag)</span> </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Stem.Models.Tag({
                        <span class="hljs-string">'selected'</span>: <span class="hljs-literal">false</span>,
                        <span class="hljs-string">'label'</span>: tag
                    });
                })

            );

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h2 id="updatecontentfilters-">updateContentFilters()</h2>
<p>Update the content filters whenever a user makes a
change to the selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        updateContentFilters: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">this</span>.filters.content.tags = <span class="hljs-keyword">this</span>.contentTagSet.getSelectedTags();
            <span class="hljs-keyword">this</span>.filteredContent.refilter();

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2 id="setupgroups">setupGroups</h2>
<p>Set up the models and collections for groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        
        setupGroups: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Create a collection of group objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.groups = <span class="hljs-keyword">new</span> Stem.Collections.Groups([], {
                limit: <span class="hljs-number">99</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Create a collection of tags for groups</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.groupTags = <span class="hljs-keyword">new</span> Stem.Collections.Tags();</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>And create a model for the set of group tags.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
            <span class="hljs-keyword">this</span>.groupTagSet = <span class="hljs-keyword">new</span> Stem.Models.TagSet({
                tags: <span class="hljs-keyword">this</span>.groupTags,
                title: <span class="hljs-string">'Topics'</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Update the tags whenever the underlying
collection changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.groups.on(<span class="hljs-string">'sync reset'</span>, <span class="hljs-keyword">this</span>.updateGroupTags, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Update the tag filters whenever the user changes one.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.groupTags.on(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.updateGroupFilters, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Populate the collections with content from the OAE.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.groups.fetch();

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h2 id="updategrouptags-">updateGroupTags()</h2>
<p>Update the list of valid tags for groups whenever
the group collection itself changes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        updateGroupTags: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Reset the content tags collection with
an updated array of models.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.groupTags.reset(</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Create models from the tags now
available in the groups collection.
Initially no tags are selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
                <span class="hljs-keyword">this</span>.groups.getTags().map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tag)</span> </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Stem.Models.Tag({
                        <span class="hljs-string">'selected'</span>: <span class="hljs-literal">false</span>,
                        <span class="hljs-string">'label'</span>:  tag
                    });
                })

            );

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <h2 id="updategroupfilters-">updateGroupFilters()</h2>
<p>Update the group filters whenever a user makes a
change to the selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        updateGroupFilters: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">this</span>.filters.group.tags = <span class="hljs-keyword">this</span>.groupTagSet.getSelectedTags();
            <span class="hljs-keyword">this</span>.filteredGroups.refilter();

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <h2 id="setupproposals">setupProposals</h2>
<p>Set up the models and collections for proposals.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        
        setupProposals: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Create the collection of completed proposals.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.completedProposals = <span class="hljs-keyword">new</span> Stem.Collections.Proposals([], {
                historical: <span class="hljs-literal">true</span>,
                maxSize:    <span class="hljs-number">5</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Retrieve the data from DonorsChoose.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.completedProposals.fetch();

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h2 id="setupgradelevels">setupGradeLevels</h2>
<p>Set up the models and collections for managing grade levels.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        
        setupGradeLevels: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Create a model to store the grade level. For
maximum flexibility we allow no grade levels
and multiple grade levels. We implement this
as a tag set.</p>

            </div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Create a collection of tags for content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.gradeTags = <span class="hljs-keyword">new</span> Stem.Collections.Tags([
                <span class="hljs-keyword">new</span> Stem.Models.Tag({
                    <span class="hljs-string">'selected'</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-string">'label'</span>: <span class="hljs-string">'K-2'</span>
                }),
                <span class="hljs-keyword">new</span> Stem.Models.Tag({
                    <span class="hljs-string">'selected'</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-string">'label'</span>: <span class="hljs-string">'3-5'</span>
                }),
                <span class="hljs-keyword">new</span> Stem.Models.Tag({
                    <span class="hljs-string">'selected'</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-string">'label'</span>: <span class="hljs-string">'6-8'</span>
                }),
                <span class="hljs-keyword">new</span> Stem.Models.Tag({
                    <span class="hljs-string">'selected'</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-string">'label'</span>: <span class="hljs-string">'9-12'</span>
                })
            ]);</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>And create a model for the set of content tags.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
            <span class="hljs-keyword">this</span>.gradeTagSet = <span class="hljs-keyword">new</span> Stem.Models.TagSet({
                tags: <span class="hljs-keyword">this</span>.gradeTags,
                title: <span class="hljs-string">'Grade level'</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Update the tag filters whenever the user changes grades.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.gradeTags.on(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.updateContentFilters, <span class="hljs-keyword">this</span>)
                          .on(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>.updateGroupFilters, <span class="hljs-keyword">this</span>);

        },</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <h2 id="initialize-">initialize()</h2>
<p>Initialize the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">var</span> view = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Kick off the initialization process by
requesting data from the various
collections that will be a part of the
view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
            <span class="hljs-keyword">this</span>.setupContent();
            <span class="hljs-keyword">this</span>.setupGroups();
            <span class="hljs-keyword">this</span>.setupProposals();</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Now that we’ve started gathering the data
for the view, we can set up the high-level
user interactions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
            <span class="hljs-keyword">this</span>.setupGradeLevels();</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Create a filtered content collection to reflect
the user’s selections.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.filteredContent = <span class="hljs-keyword">new</span> FilteredCollection(<span class="hljs-keyword">this</span>.content);
            <span class="hljs-keyword">this</span>.filteredContent.filterBy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> </span>{
                <span class="hljs-keyword">return</span> view.filterModel(model, view.filters.content.tags);
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Create a filtered groups collection to reflect
the user’s selections.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.filteredGroups = <span class="hljs-keyword">new</span> FilteredCollection(<span class="hljs-keyword">this</span>.groups);
            <span class="hljs-keyword">this</span>.filteredGroups.filterBy(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> </span>{
                <span class="hljs-keyword">return</span> view.filterModel(model, view.filters.group.tags);
            });

        },

        render: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Rendering this view is really nothing
much more than creating and rendering
the appropriate child views. We do perform
a small bit of trickery with the first
view by overriding the main label. Normally
the view gets this value from the model,
and since we’re showing the same model in
many views, we don’t want to change the
model’s value.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
            <span class="hljs-keyword">new</span> Stem.Views.TagSetAsHorizontalSelection({
                el: $(<span class="hljs-string">'#grade-selection'</span>)[<span class="hljs-number">0</span>],
                model: <span class="hljs-keyword">this</span>.gradeTagSet
            }).render().$el.
                find(<span class="hljs-string">'label.horizontal-selection__label'</span>).
                text(<span class="hljs-string">'I teach:'</span>);

            <span class="hljs-keyword">new</span> Stem.Views.TagSetAsVerticalSelection({
                el: $(<span class="hljs-string">'#content-tags'</span>)[<span class="hljs-number">0</span>],
                model: <span class="hljs-keyword">this</span>.contentTagSet
            }).render();

            <span class="hljs-keyword">new</span> Stem.Views.TagSetAsVerticalSelection({
                el: $(<span class="hljs-string">'#content-grades'</span>)[<span class="hljs-number">0</span>],
                model: <span class="hljs-keyword">this</span>.gradeTagSet
            }).render();

            <span class="hljs-keyword">new</span> Stem.Views.ContentAsFeaturedDetails({
                collection: <span class="hljs-keyword">this</span>.filteredContent,
                el: $(<span class="hljs-string">'#content-details'</span>)[<span class="hljs-number">0</span>]
            }).render();

            <span class="hljs-keyword">new</span> Stem.Views.TagSetAsVerticalSelection({
                el: $(<span class="hljs-string">'#group-tags'</span>)[<span class="hljs-number">0</span>],
                model: <span class="hljs-keyword">this</span>.groupTagSet
            }).render();

            <span class="hljs-keyword">new</span> Stem.Views.TagSetAsVerticalSelection({
                el: $(<span class="hljs-string">'#group-grades'</span>)[<span class="hljs-number">0</span>],
                model: <span class="hljs-keyword">this</span>.gradeTagSet
            }).render();

            <span class="hljs-keyword">new</span> Stem.Views.GroupsAsFeaturedDetails({
                collection: <span class="hljs-keyword">this</span>.filteredGroups,
                el: $(<span class="hljs-string">'#group-details'</span>)[<span class="hljs-number">0</span>]
            }).render();

            <span class="hljs-keyword">new</span> Stem.Views.CompletedProposalsAsFeaturedDetails({
                collection: <span class="hljs-keyword">this</span>.completedProposals,
                el: $(<span class="hljs-string">'#proposals-details'</span>)[<span class="hljs-number">0</span>]
            }).render();

        }

    });

})();</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
